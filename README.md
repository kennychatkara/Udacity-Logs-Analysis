# Logs Analysis App

**Description**
---------------
A logs analysis application working as an internal reporting tool for an example newspaper website. This reporting tool is a Python app which connects to a PostgreSQL database to analyze the logs generated by the newspaper website. Complex SQL queries are run against the log and site data to generate an analysis report detailing how users use the newspaper site.


**Download**
---------------
To download the project source code, simply clone the repository or download and extract the zip of the repository.

**System Requirements**
- Python 2.7+
- [VirtualBox](https://www.virtualbox.org/)
- [Vagrant](https://www.vagrantup.com/)

**Requirements Installation**
- To install [VirtualBox](https://www.virtualbox.org/wiki/Downloads), download and install the 'platform package' for your operating system
- To install [Vagrant](https://www.vagrantup.com/downloads.html), download and install the package for your operating system


**Setup**
---------------
1. After successful installation of the system requirements, download/clone the repository for the virtual machine (VM) configuration 'fullstack-nanodegree-vm' from [here](https://github.com/kennychatkara/fullstack-nanodegree-vm) or [here](https://github.com/udacity/fullstack-nanodegree-vm)

2. Go to the 'vagrant' subdirectory of the downloaded VM configuration 'fullstack-nanodegree-vm' directory
    - Open the command line interface application ("Terminal" application on Mac, Linux; "Command Prompt" application on Windows) and change directory to the 'vagrant' directory
        ```bash
        cd fullstack-nanodegree-vm/vagrant    # change directory to the vagrant directory
        ```

3. Download/clone this project's source code into the vagrant directory
    ```bash
    git clone https://github.com/kennychatkara/Udacity-Logs-Analysis.git    # to clone this project's source code
    ```

4. Download and extract the zip file of the newspaper site's data from [here](https://d17h27t6h515a5.cloudfront.net/topher/2016/August/57b5f748_newsdata/newsdata.zip) and place the extracted 'newsdata.sql' file inside this 'fullstack-nanodegree-vm/vagrant/Udacity-Logs-Analysis' project directory 

5. Using the Terminal application, **from within the vagrant directory**, install/start and connect to the VM:
    ```bash
    vagrant up    # to install and start the vagrant VM
    vagrant ssh   # to connect to the VM
    ```
    
6. **Once connected to the VM**, change directory to the Udacity-Logs-Analysis project directory inside the VM's shared vagrant directory and setup the database with the newspaper site's data:
    ```bash
    cd /vagrant/Udacity-Logs-Analysis    # change directory to the VM's Udacity-Logs-Analysis directory
    ```
    - Load the newspaper site's data from the 'newsdata.sql' file into the 'news' PostgreSQL database by entering the following command:
      ```bash
      psql -d news -f newsdata.sql         # load newspaper site's data into 'news' database
      ```
    - Finally, while connected to the PostgreSQL 'news' database (after previous 'psql -d news' command), run the following SQL queries to create the views used by this Logs Analysis application:
      ```sql
      # article_views - View for showing the number of views each article has received
      CREATE VIEW article_views AS SELECT author, title, count FROM articles JOIN (SELECT substring(path from '/article/(.*)') as path_slug, count(*) FROM log WHERE path ~ '/article/*' AND status = '200 OK' GROUP BY path) AS views ON articles.slug = views.path_slug;

      # request_count - View for showing the total number of requests the newspaper site received per day
      CREATE VIEW request_count AS SELECT time::date, count(*) as requests FROM log GROUP BY time::date;

      # error_count - View for showing the number of unsuccessful requests the newspaper site received per day
      CREATE VIEW error_count AS SELECT time::date, count(*) AS errors FROM log WHERE status != '200 OK' GROUP BY time::date;
      ```


**Run**
---------------
To run the application, **from within the VM's '/vagrant/Udacity-Logs-Analysis' directory**, run:
```bash
python logs_analysis.py
```
The report will be printed in the Terminal console.
